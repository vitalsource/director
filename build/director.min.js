

//
// Generated on Mon Jul 27 2015 23:40:23 GMT-0400 (EDT) by Charlie Robbins, Paolo Fragomeni & the Contributors (Using Codesurgeon).
// Version 1.2.8
//
(function(a){function d(){return b.hash===""||b.hash==="#"}function g(a,b){for(var c=0;c<a.length;c+=1)if(b(a[c],c,a)===!1)return}function h(a){var b=[];for(var c=0,d=a.length;c<d;c++)b=b.concat(a[c]);return b}function i(a,b,c){if(!a.length)return c();var d=0;(function e(){b(a[d],function(b){b||b===!1?(c(b),c=function(){}):(d+=1,d===a.length?c():e())})})()}function j(a,b,c){c=a;for(var d in b)if(b.hasOwnProperty(d)){c=b[d](a);if(c!==a)break}return c===a?"([._a-zA-Z0-9-%()]+)":c}function k(a,b){var c,d=0,e="";while(c=a.substr(d).match(/[^\w\d\- %@&]*\*[^\w\d\- %@&]*/))d=c.index+c[0].length,c[0]=c[0].replace(/^\*/,"([_.()!\\ %@&a-zA-Z0-9-]+)"),e+=a.substr(0,c.index)+c[0];a=e+=a.substr(d);var f=a.match(/:([^\/]+)/ig),g,h;if(f){h=f.length;for(var i=0;i<h;i++)g=f[i],g.slice(0,2)==="::"?a=g.slice(1):a=a.replace(g,j(g,b))}return a}function l(a,b,c,d){var e=0,f=0,g=0,c=(c||"(").toString(),d=(d||")").toString(),h;for(h=0;h<a.length;h++){var i=a[h];if(i.indexOf(c,e)>i.indexOf(d,e)||~i.indexOf(c,e)&&!~i.indexOf(d,e)||!~i.indexOf(c,e)&&~i.indexOf(d,e)){f=i.indexOf(c,e),g=i.indexOf(d,e);if(~f&&!~g||!~f&&~g){var j=a.slice(0,(h||1)+1).join(b);a=[j].concat(a.slice((h||1)+1))}e=(g>f?g:f)+1,h=0}else e=0}return a}var b=document.location,c=/\?.*/,e={mode:"modern",hash:b.hash,history:!1,skip:!1,check:function(){var a=b.hash;a!=this.hash&&(this.hash=a,this.onHashChanged())},fire:function(){this.mode==="modern"?this.history===!0?window.onpopstate():window.onhashchange():this.onHashChanged()},init:function(a,b){function d(a){if(!c.skip)for(var b=0,d=f.listeners.length;b<d;b++)f.listeners[b](a);c.skip=!1}var c=this;this.history=b,f.listeners||(f.listeners=[]);if("onhashchange"in window&&(document.documentMode===undefined||document.documentMode>7))this.history===!0?setTimeout(function(){window.onpopstate=d},500):window.onhashchange=d,this.mode="modern";else{var e=document.createElement("iframe");e.id="state-frame",e.style.display="none",document.body.appendChild(e),this.writeFrame(""),"onpropertychange"in document&&"attachEvent"in document&&document.attachEvent("onpropertychange",function(){event.propertyName==="location"&&c.check()}),window.setInterval(function(){c.check()},50),this.onHashChanged=d,this.mode="legacy"}return f.listeners.push(a),this.mode},destroy:function(a){if(!f||!f.listeners)return;var b=f.listeners;for(var c=b.length-1;c>=0;c--)b[c]===a&&b.splice(c,1)},setHash:function(a){return this.mode==="legacy"&&this.writeFrame(a),this.history===!0?(window.history.pushState({},document.title,a),this.fire()):b.hash=a[0]==="/"?a:"/"+a,this},writeFrame:function(a){var b=document.getElementById("state-frame"),c=b.contentDocument||b.contentWindow.document;c.open(),c.write("<script>_hash = '"+a+"'; onload = parent.listener.syncHash;<script>"),c.close()},syncHash:function(){var a=this._hash;return a!=b.hash&&(b.hash=a),this},onHashChanged:function(){}},f=a.Router=function(a){if(this instanceof f)this.params={},this.routes={},this.methods=["on","once","after","before"],this.scope=[],this._methods={},this._insert=this.insert,this.insert=this.insertEx,this.historySupport=(window.history!=null?window.history.pushState:null)!=null,this.configure(),this.mount(a||{});else return new f(a)};f.prototype.init=function(a){var c=this,f;this.handler=function(a){var b=a&&a.newURL||window.location.hash,d=c.history===!0?c.getPath():b.replace(/.*#/,"");c.dispatch("on",d.charAt(0)==="/"?d:"/"+d)},e.init(this.handler,this.history);var g=d();return this.history===!1?g&&a?b.hash=a:g||c.dispatch("on","/"+b.hash.replace(/^(#\/|#|\/)/,"")):(this.convert_hash_in_init?(f=g&&a?a:g?null:b.hash.replace(/^#/,""),f&&window.history.replaceState({},document.title,f)):f=this.getPath(),(f||this.run_in_init===!0)&&this.handler()),this},f.prototype.explode=function(a){var d=this.history===!0?this.getPath():b.hash;return a===!0&&(d=d.replace(c,"")),d.charAt(1)==="/"&&(d=d.slice(1)),d.slice(1,d.length).split("/")},f.prototype.setRoute=function(a,b,c,d){var f=this.explode();return typeof a=="number"&&typeof b=="string"?(f[a]=b,d=c):typeof c=="string"?f.splice(a,b,s):(f=[a],d=b),e.skip=d,e.setHash(f.join("/")),f},f.prototype.insertEx=function(a,b,c,d){return a==="once"&&(a="on",c=function(a){var b=!1;return function(){if(b)return;return b=!0,a.apply(this,arguments)}}(c)),this._insert(a,b,c,d)},f.prototype.getRoute=function(a){var b=a;if(typeof a=="number")b=this.explode(!0)[a];else if(typeof a=="string"){var c=this.explode(!0);b=c.indexOf(a)}else b=this.explode(!0);return b},f.prototype.destroy=function(){return e.destroy(this.handler),this},f.prototype.getPath=function(){var a=window.location.pathname;return a.substr(0,1)!=="/"&&(a="/"+a),a.replace(c,"")};var c=/\?.*/;f.prototype.configure=function(a){a=a||{};for(var b=0;b<this.methods.length;b++)this._methods[this.methods[b]]=!0;return this.recurse=typeof a.recurse=="undefined"?this.recurse||!1:a.recurse,this.async=a.async||!1,this.delimiter=a.delimiter||"/",this.strict=typeof a.strict=="undefined"?!0:a.strict,this.notfound=a.notfound,this.resource=a.resource,this.history=a.html5history&&this.historySupport||!1,this.run_in_init=this.history===!0&&a.run_handler_in_init!==!1,this.convert_hash_in_init=this.history===!0&&a.convert_hash_in_init!==!1,this.every={after:a.after||null,before:a.before||null,on:a.on||null},this},f.prototype.param=function(a,b){a[0]!==":"&&(a=":"+a);var c=new RegExp(a,"g");return this.params[a]=function(a){return a.replace(c,b.source||b)},this},f.prototype.on=f.prototype.route=function(a,b,c){var d=this;return!c&&typeof b=="function"&&(c=b,b=a,a="on"),Array.isArray(b)?b.forEach(function(b){d.on(a,b,c)}):(b.source&&(b=b.source.replace(/\\\//ig,"/")),Array.isArray(a)?a.forEach(function(a){d.on(a.toLowerCase(),b,c)}):(b=b.split(new RegExp(this.delimiter)),b=l(b,this.delimiter),this.insert(a,this.scope.concat(b),c),this))},f.prototype.path=function(a,b){var c=this,d=this.scope.length;return a.source&&(a=a.source.replace(/\\\//ig,"/")),a=a.split(new RegExp(this.delimiter)),a=l(a,this.delimiter),this.scope=this.scope.concat(a),b.call(this,this),this.scope.splice(d,a.length),this},f.prototype.dispatch=function(a,b,d){function j(){f.last=g.after,f.invoke(f.runlist(g),f,d)}var e=this.parseQuery(b);b=b.replace(c,"");var f=this,g=this.traverse(a,b,this.routes,""),h=this._invoked,i;return this._invoked=!0,!g||g.length===0?(this.last=[],typeof this.notfound=="function"&&this.invoke([this.notfound],{method:a,path:b},d),!1):(this.query=e,this.recurse==="forward"&&(g=g.reverse()),i=this.every&&this.every.after?[this.every.after].concat(this.last):[this.last],i&&i.length>0&&h?(this.async?this.invoke(i,this,j):(this.invoke(i,this),j()),!0):(j(),!0))},f.prototype.invoke=function(a,b,c){var d=this,e;this.async?(e=function(c,d){if(Array.isArray(c))return i(c,e,d);typeof c=="function"&&c.apply(b,(a.captures||[]).concat(d))},i(a,e,function(){c&&c.apply(b,arguments)})):(e=function(c){if(Array.isArray(c))return g(c,e);if(typeof c=="function")return c.apply(b,a.captures||[]);typeof c=="string"&&d.resource&&d.resource[c].apply(b,a.captures||[])},g(a,e))},f.prototype.traverse=function(a,b,c,d,e){function l(a){function b(a){var c=[];for(var d=0;d<a.length;d++)c[d]=Array.isArray(a[d])?b(a[d]):a[d];return c}function c(a){for(var b=a.length-1;b>=0;b--)Array.isArray(a[b])?(c(a[b]),a[b].length===0&&a.splice(b,1)):e(a[b])||a.splice(b,1)}if(!e)return a;var d=b(a);return d.matched=a.matched,d.captures=a.captures,d.after=a.after.filter(e),c(d),d}var f=[],g,h,i,j,k;if(b===this.delimiter&&c[a])return j=[[c.before,c[a]].filter(Boolean)],j.after=[c.after].filter(Boolean),j.matched=!0,j.captures=[],l(j);for(var m in c)if(c.hasOwnProperty(m)&&(!this._methods[m]||this._methods[m]&&typeof c[m]=="object"&&!Array.isArray(c[m]))){g=h=d+this.delimiter+m,this.strict||(h+="["+this.delimiter+"]?"),i=b.match(new RegExp("^"+h));if(!i)continue;if(i[0]&&i[0]==b&&c[m][a])return j=[[c[m].before,c[m][a]].filter(Boolean)],j.after=[c[m].after].filter(Boolean),j.matched=!0,j.captures=i.slice(1),this.recurse&&c===this.routes&&(j.push([c.before,c.on].filter(Boolean)),j.after=j.after.concat([c.after].filter(Boolean))),l(j);j=this.traverse(a,b,c[m],g);if(j.matched)return j.length>0&&(f=f.concat(j)),this.recurse&&(f.push([c[m].before,c[m][a]].filter(Boolean)),j.after=j.after.concat([c[m].after].filter(Boolean)),c===this.routes&&(f.push([c.before,c.on].filter(Boolean)),j.after=j.after.concat([c.after].filter(Boolean)))),f.matched=!0,f.captures=j.captures,f.after=j.after,l(f)}return!1},f.prototype.insert=function(a,b,c,d){var e,f,g,h,i;b=b.filter(function(a){return a&&a.length>0}),d=d||this.routes,i=b.shift(),/\:|\*/.test(i)&&!/\\d|\\w/.test(i)&&(i=k(i,this.params));if(b.length>0)return d[i]=d[i]||{},this.insert(a,b,c,d[i]);if(!i&&!b.length&&d===this.routes){e=typeof d[a];switch(e){case"function":d[a]=[d[a],c];return;case"object":d[a].push(c);return;case"undefined":d[a]=c;return}return}f=typeof d[i],g=Array.isArray(d[i]);if(d[i]&&!g&&f=="object"){e=typeof d[i][a];switch(e){case"function":d[i][a]=[d[i][a],c];return;case"object":d[i][a].push(c);return;case"undefined":d[i][a]=c;return}}else if(f=="undefined"){h={},h[a]=c,d[i]=h;return}throw new Error("Invalid route context: "+f)},f.prototype.extend=function(a){function e(a){b._methods[a]=!0,b[a]=function(){var c=arguments.length===1?[a,""]:[a];b.on.apply(b,c.concat(Array.prototype.slice.call(arguments)))}}var b=this,c=a.length,d;for(d=0;d<c;d++)e(a[d])},f.prototype.runlist=function(a){var b=this.every&&this.every.before?[this.every.before].concat(h(a)):h(a);return this.every&&this.every.on&&b.push(this.every.on),b.captures=a.captures,b.source=a.source,b},f.prototype.mount=function(a,b){function d(b,d){var e=b,f=b.split(c.delimiter),g=typeof a[b],h=f[0]===""||!c._methods[f[0]],i=h?"on":e;h&&(e=e.slice((e.match(new RegExp("^"+c.delimiter))||[""])[0].length),f.shift());if(h&&g==="object"&&!Array.isArray(a[b])){d=d.concat(f),c.mount(a[b],d);return}h&&(d=d.concat(e.split(c.delimiter)),d=l(d,c.delimiter)),c.insert(i,d,a[b])}if(!a||typeof a!="object"||Array.isArray(a))return;var c=this;b=b||[],Array.isArray(b)||(b=b.split(c.delimiter));for(var e in a)a.hasOwnProperty(e)&&d(e,b.slice(0))},f.prototype.parseQuery=function(a){function g(a,b){e.hasOwnProperty(a)?Array.isArray(e[a])?e[a].push(b):e[a]=[e[a],b]:e[a]=b}var b=a.match(c);if(!b)return null;var d=b[0].substr(1),e={},f=decodeURIComponent;return d.length&&d.split(/&/g).forEach(function(a){var b=a.split("="),c=f(b.shift()),d=b.length?f(b.join("=")):!0;g(c,d)}),e}})(typeof exports=="object"?exports:window)